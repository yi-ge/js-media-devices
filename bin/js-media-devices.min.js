!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).JsMediaDevices=t()}(this,function(){"use strict";function c(e,t,r,n,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,i)}function d(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}var e,j,t=(j=e={exports:{}},function(e){function o(e,t,r,n){var o,a,u,c,i=t&&t.prototype instanceof p?t:p,s=Object.create(i.prototype),f=new d(n||[]);return s._invoke=(o=e,a=r,u=f,c="suspendedStart",function(e,t){if("executing"===c)throw new Error("Generator is already running");if("completed"===c){if("throw"===e)throw t;return v()}for(u.method=e,u.arg=t;;){var r=u.delegate;if(r){var n=l(r,u);if(n){if(n===L)continue;return n}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if("suspendedStart"===c)throw c="completed",u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c="executing";var i=h(o,a,u);if("normal"===i.type){if(c=u.done?"completed":"suspendedYield",i.arg===L)continue;return{value:i.arg,done:u.done}}"throw"===i.type&&(c="completed",u.method="throw",u.arg=i.arg)}}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function p(){}function r(){}function t(){}function n(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function a(u){function c(e,t,r,n){var i=h(u[e],u,t);if("throw"!==i.type){var o=i.arg,a=o.value;return a&&"object"==typeof a&&y.call(a,"__await")?Promise.resolve(a.__await).then(function(e){c("next",e,r,n)},function(e){c("throw",e,r,n)}):Promise.resolve(a).then(function(e){o.value=e,r(o)},function(e){return c("throw",e,r,n)})}n(i.arg)}var t;this._invoke=function(r,n){function e(){return new Promise(function(e,t){c(r,n,e,t)})}return t=t?t.then(e,e):e()}}function l(e,t){var r=e.iterator[t.method];if(r===s){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=s,l(e,t),"throw"===t.method))return L;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return L}var n=h(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,L;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=s),t.delegate=null,L):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,L)}function i(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function u(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function d(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(i,this),this.reset(!0)}function c(t){if(t){var e=t[m];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(y.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=s,e.done=!0,e};return n.next=n}}return{next:v}}function v(){return{value:s,done:!0}}var s,f=Object.prototype,y=f.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},m=g.iterator||"@@iterator",w=g.asyncIterator||"@@asyncIterator",x=g.toStringTag||"@@toStringTag",k=e.regeneratorRuntime;if(k)j.exports=k;else{(k=e.regeneratorRuntime=j.exports).wrap=o;var L={},b={};b[m]=function(){return this};var D=Object.getPrototypeOf,E=D&&D(D(c([])));E&&E!==f&&y.call(E,m)&&(b=E);var O=t.prototype=p.prototype=Object.create(b);r.prototype=O.constructor=t,t.constructor=r,t[x]=r.displayName="GeneratorFunction",k.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===r||"GeneratorFunction"===(t.displayName||t.name))},k.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,t):(e.__proto__=t,!(x in e)&&(e[x]="GeneratorFunction")),e.prototype=Object.create(O),e},k.awrap=function(e){return{__await:e}},n(a.prototype),a.prototype[w]=function(){return this},k.AsyncIterator=a,k.async=function(e,t,r,n){var i=new a(o(e,t,r,n));return k.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},n(O),O[x]="Generator",O[m]=function(){return this},O.toString=function(){return"[object Generator]"},k.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},k.values=c,d.prototype={constructor:d,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(u),!e)for(var t in this)"t"===t.charAt(0)&&y.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=s),!!t}if(this.done)throw r;for(var n=this,t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=y.call(i,"catchLoc"),u=y.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r,n=this.tryEntries.length-1;0<=n;--n)if((r=this.tryEntries[n]).tryLoc<=this.prev&&y.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,L):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),L},finish:function(e){for(var t,r=this.tryEntries.length-1;0<=r;--r)if((t=this.tryEntries[r]).finallyLoc===e)return this.complete(t.completion,t.afterLoc),u(t),L},catch:function(e){for(var t,r=this.tryEntries.length-1;0<=r;--r)if((t=this.tryEntries[r]).tryLoc===e){var n=t.completion;if("throw"===n.type){var i=n.arg;u(t)}return i}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:c(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=s),L}}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")()),e.exports),r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),n=r.regeneratorRuntime&&0<=Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime"),i=n&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,n)r.regeneratorRuntime=i;else try{delete r.regeneratorRuntime}catch(c){r.regeneratorRuntime=void 0}var v=t,y=function(u){return function(){var e=this,a=arguments;return new Promise(function(t,r){function n(e){c(o,t,r,n,i,"next",e)}function i(e){c(o,t,r,n,i,"throw",e)}var o=u.apply(e,a);n(void 0)})}};return function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.deviceList=null}return t=e,(r=[{key:"checkMediaDevicesSupport",value:function(){if(!navigator)throw new Error("navigator not supported.");if(!navigator.mediaDevices)throw new Error("mediaDevices not supported.");if(!navigator.mediaDevices.enumerateDevices)throw new Error("mediaDevices.enumerateDevices() not supported.");return!0}},{key:"stopMediaTracks",value:function(e){e.getTracks().forEach(function(e){e.stop()})}},{key:"getVideoMedia",value:(l=y(v.mark(function e(t){var r;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:t}},audio:!1});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)})),function(){return l.apply(this,arguments)})},{key:"getAudioMedia",value:(p=y(v.mark(function e(t){var r;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!1,audio:{deviceId:{exact:t}}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)})),function(){return p.apply(this,arguments)})},{key:"getVideoAndAudioMedia",value:(h=y(v.mark(function e(t,r){var n;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:t}},audio:{deviceId:{exact:r}}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)})),function(){return h.apply(this,arguments)})},{key:"getDeviceList",value:(f=y(v.mark(function e(){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:return this.deviceList=e.sent,e.abrupt("return",this.deviceList);case 6:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)})},{key:"getOnlyAudioDeviceList",value:(s=y(v.mark(function e(){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 2:return e.abrupt("return",navigator.mediaDevices.enumerateDevices());case 3:case"end":return e.stop()}},e)})),function(){return s.apply(this,arguments)})},{key:"getOnlyVideoDeviceList",value:(c=y(v.mark(function e(){return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 2:return e.abrupt("return",navigator.mediaDevices.enumerateDevices());case 3:case"end":return e.stop()}},e)})),function(){return c.apply(this,arguments)})},{key:"getAudioDeviceList",value:(u=y(v.mark(function e(){var t;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.deviceList,e.t0){e.next=5;break}return e.next=4,this.getDeviceList();case 4:e.t0=e.sent;case 5:return t=e.t0,e.abrupt("return",t.filter(function(e){return"audioinput"===e.kind||"audiooutput"===e.kind}));case 7:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"getVideoDeviceList",value:(a=y(v.mark(function e(){var t;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.deviceList,e.t0){e.next=5;break}return e.next=4,this.getDeviceList();case 4:e.t0=e.sent;case 5:return t=e.t0,e.abrupt("return",t.filter(function(e){return"videoinput"===e.kind}));case 7:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"getOutAudioDeviceList",value:(o=y(v.mark(function e(){var t;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.deviceList,e.t0){e.next=5;break}return e.next=4,this.getDeviceList();case 4:e.t0=e.sent;case 5:return t=e.t0,e.abrupt("return",t.filter(function(e){return"audiooutput"===e.kind}));case 7:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"getInAudioDeviceList",value:(i=y(v.mark(function e(){var t;return v.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.deviceList,e.t0){e.next=5;break}return e.next=4,this.getDeviceList();case 4:e.t0=e.sent;case 5:return t=e.t0,e.abrupt("return",t.filter(function(e){return"audioinput"===e.kind}));case 7:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"setOutAudioDevices",value:function(t,n){return new Promise(function(e,r){void 0===t.sinkId?console.warn("Browser does not support output device selection."):t.setSinkId(n).then(function(){console.log("Success, audio output device attached: ".concat(n," to element with ").concat(t.title," as source.")),e(!0)}).catch(function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: ".concat(e)),console.error(t),r(t)})})}}])&&d(t.prototype,r),n&&d(t,n),e;var t,r,n,i,o,a,u,c,s,f,h,p,l}()});