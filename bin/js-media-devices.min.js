!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"==typeof globalThis?e||self:globalThis).JsMediaDevices=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var h=e(t(function(e){function c(e,t,r,n,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return r(e),0}u.done?t(c):Promise.resolve(c).then(n,i)}e.exports=function(u){return function(){var e=this,a=arguments;return new Promise(function(t,r){function n(e){c(o,t,r,n,i,"next",e)}function i(e){c(o,t,r,n,i,"throw",e)}var o=u.apply(e,a);n(void 0)})}},e.exports.default=e.exports,e.exports.__esModule=!0})),d=e(t(function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0})),p=e(t(function(e){function n(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0})),l=t(function(e){var t=function(a){function r(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}function u(e,t,r,n){var i,o,a,u,t=t&&t.prototype instanceof s?t:s,t=Object.create(t.prototype),n=new h(n||[]);return t._invoke=(i=e,o=r,a=n,u="suspendedStart",function(e,t){if("executing"===u)throw new Error("Generator is already running");if("completed"===u){if("throw"===e)throw t;return p()}for(a.method=e,a.arg=t;;){var r=a.delegate;if(r){var n=function e(t,r){var n=t.iterator[r.method];if(n===l){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=l,e(t,r),"throw"===r.method))return b;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var n=c(n,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,b;n=n.arg;if(!n)return r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b;{if(!n.done)return n;r[t.resultName]=n.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=l)}return r.delegate=null,b}(r,a);if(n){if(n===b)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===u)throw u="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);u="executing";n=c(i,o,a);if("normal"===n.type){if(u=a.done?"completed":"suspendedYield",n.arg===b)continue;return{value:n.arg,done:a.done}}"throw"===n.type&&(u="completed",a.method="throw",a.arg=n.arg)}}),t}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function s(){}function t(){}function n(){}function e(e){["next","throw","return"].forEach(function(t){r(e,t,function(e){return this._invoke(t,e)})})}function f(a,u){var t;this._invoke=function(r,n){function e(){return new u(function(e,t){!function t(e,r,n,i){e=c(a[e],a,r);if("throw"!==e.type){var o=e.arg;return(r=o.value)&&"object"==typeof r&&y.call(r,"__await")?u.resolve(r.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):u.resolve(r).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,i)})}i(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function i(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function o(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(i,this),this.reset(!0)}function d(t){if(t){var e=t[m];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function e(){for(;++r<t.length;)if(y.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=l,e.done=!0,e};return e.next=e}}return{next:p}}function p(){return{value:l,done:!0}}var l,v=Object.prototype,y=v.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},m=g.iterator||"@@iterator",w=g.asyncIterator||"@@asyncIterator",x=g.toStringTag||"@@toStringTag";try{r({},"")}catch(a){r=function(e,t,r){return e[t]=r}}a.wrap=u;var b={},k={};k[m]=function(){return this};g=Object.getPrototypeOf,g=g&&g(g(d([])));g&&g!==v&&y.call(g,m)&&(k=g);var L=n.prototype=s.prototype=Object.create(k);return((t.prototype=L.constructor=n).constructor=t).displayName=r(n,x,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===t||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,n):(e.__proto__=n,r(e,x,"GeneratorFunction")),e.prototype=Object.create(L),e},a.awrap=function(e){return{__await:e}},e(f.prototype),f.prototype[w]=function(){return this},a.AsyncIterator=f,a.async=function(e,t,r,n,i){void 0===i&&(i=Promise);var o=new f(u(e,t,r,n),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},e(L),r(L,x,"Generator"),L[m]=function(){return this},L.toString=function(){return"[object Generator]"},a.keys=function(r){var e,n=[];for(e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=d,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(o),!e)for(var t in this)"t"===t.charAt(0)&&y.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=l),!!t}if(this.done)throw r;for(var n=this,t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=y.call(i,"catchLoc"),u=y.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var r,n=this.tryEntries.length-1;0<=n;--n)if((r=this.tryEntries[n]).tryLoc<=this.prev&&y.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t,r=this.tryEntries.length-1;0<=r;--r)if((t=this.tryEntries[r]).finallyLoc===e)return this.complete(t.completion,t.afterLoc),o(t),b},catch:function(e){for(var t,r=this.tryEntries.length-1;0<=r;--r)if((t=this.tryEntries[r]).tryLoc===e){var n,i=t.completion;return"throw"===i.type&&(n=i.arg,o(t)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:d(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=l),b}},a}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}});return function(){function e(){d(this,e),this.deviceList=[]}return p(e,[{key:"checkMediaDevicesSupport",value:function(){if(!navigator)throw new Error("navigator not supported.");if(!navigator.mediaDevices)throw new Error("mediaDevices not supported.");if(!navigator.mediaDevices.enumerateDevices)throw new Error("mediaDevices.enumerateDevices() not supported.");return!0}},{key:"stopMediaTracks",value:function(e){e.getTracks().forEach(function(e){e.stop()})}},{key:"getVideoMedia",value:(f=h(l.mark(function e(t,r){var n,i,o,a,u;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object.assign({minWidth:null,minHeight:null,width:null,height:null},r),n=a.minWidth,i=a.minHeight,o=a.width,a=a.height,o&&a)return e.next=4,navigator.mediaDevices.getUserMedia({video:!t||{width:o,height:a,deviceId:{exact:t}},audio:!1});e.next=8;break;case 4:return a=e.sent,e.abrupt("return",a);case 8:if(n&&i)return e.next=11,navigator.mediaDevices.getUserMedia({video:!t||{width:{min:n},height:{min:i},deviceId:{exact:t}},audio:!1});e.next=13;break;case 11:return u=e.sent,e.abrupt("return",u);case 13:return e.next=15,navigator.mediaDevices.getUserMedia({video:!t||{deviceId:{exact:t}},audio:!1});case 15:return u=e.sent,e.abrupt("return",u);case 17:case"end":return e.stop()}},e)})),function(){return f.apply(this,arguments)})},{key:"getAudioMedia",value:(s=h(l.mark(function e(t){var r;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!1,audio:!t||{deviceId:{exact:t}}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)})),function(){return s.apply(this,arguments)})},{key:"getVideoAndAudioMedia",value:(c=h(l.mark(function e(t,r){var n;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:t}},audio:{deviceId:{exact:r}}});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)})),function(){return c.apply(this,arguments)})},{key:"getDeviceList",value:(u=h(l.mark(function e(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 2:return e.next=4,navigator.mediaDevices.enumerateDevices();case 4:return this.deviceList=e.sent,e.abrupt("return",this.deviceList);case 6:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"getOnlyAudioDeviceList",value:(a=h(l.mark(function e(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 2:return e.abrupt("return",navigator.mediaDevices.enumerateDevices());case 3:case"end":return e.stop()}},e)})),function(){return a.apply(this,arguments)})},{key:"getOnlyVideoDeviceList",value:(o=h(l.mark(function e(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 2:return e.abrupt("return",navigator.mediaDevices.enumerateDevices());case 3:case"end":return e.stop()}},e)})),function(){return o.apply(this,arguments)})},{key:"getAudioDeviceList",value:(i=h(l.mark(function e(){var t;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.deviceList.length){e.next=4;break}e.t0=this.deviceList,e.next=7;break;case 4:return e.next=6,this.getDeviceList();case 6:e.t0=e.sent;case 7:return t=e.t0,e.abrupt("return",t.filter(function(e){return"audioinput"===e.kind||"audiooutput"===e.kind}));case 9:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getVideoDeviceList",value:(n=h(l.mark(function e(){var t;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.deviceList.length){e.next=4;break}e.t0=this.deviceList,e.next=7;break;case 4:return e.next=6,this.getDeviceList();case 6:e.t0=e.sent;case 7:return t=e.t0,e.abrupt("return",t.filter(function(e){return"videoinput"===e.kind}));case 9:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"getOutAudioDeviceList",value:(r=h(l.mark(function e(){var t;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.deviceList.length){e.next=4;break}e.t0=this.deviceList,e.next=7;break;case 4:return e.next=6,this.getDeviceList();case 6:e.t0=e.sent;case 7:return t=e.t0,e.abrupt("return",t.filter(function(e){return"audiooutput"===e.kind}));case 9:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"getInAudioDeviceList",value:(t=h(l.mark(function e(){var t;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.deviceList.length){e.next=4;break}e.t0=this.deviceList,e.next=7;break;case 4:return e.next=6,this.getDeviceList();case 6:e.t0=e.sent;case 7:return t=e.t0,e.abrupt("return",t.filter(function(e){return"audioinput"===e.kind}));case 9:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"setOutAudioDevices",value:function(t,n){return new Promise(function(e,r){void 0===t.sinkId?r(new Error("Browser does not support output device selection.")):t.setSinkId(n).then(function(){e("Success, audio output device attached: ".concat(n," to element with ").concat(t.title," as source."))}).catch(function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: ".concat(e)),r(t)})})}}]),e;var t,r,n,i,o,a,u,c,s,f}()});